import networkx as NX
import matplotlib.pyplot as plt
from FUNCTIONS import unique

#Get Network
METABO_NT=NX.read_adjlist("NETWORK/ENDOGENOUS.ADJ", create_using=NX.DiGraph(), encoding="utf-8")

#Get subgraph around a metabolite i.e. Hyaluronan
TARGETS=['Hyaluronic_acid', "Hyaluronan", 'Ganglioside_GT3_(d18:0/26:0)', 'Ganglioside_GT3_(d18:0/25:0)', 'Ganglioside_GT3_(d18:0/24:0)', 'Ganglioside_GT3_(d18:0/23:0)', 'Ganglioside_GT3_(d18:0/22:0)', 'Ganglioside_GT3_(d18:0/20:0)', 'Ganglioside_GT3_(d18:0/18:0)', 'Ganglioside_GT3_(d18:0/16:0)', 'Ganglioside_GT3_(d18:0/14:0)', 'Ganglioside_GT3_(d18:0/12:0)', 'Ganglioside_GT2_(d18:0/26:0)', 'Ganglioside_GT2_(d18:0/25:0)', 'Ganglioside_GT2_(d18:0/24:0)', 'Ganglioside_GT2_(d18:0/23:0)', 'Ganglioside_GT2_(d18:0/22:0)', 'Ganglioside_GT2_(d18:0/20:0)', 'Ganglioside_GT2_(d18:0/18:0)', 'Ganglioside_GT2_(d18:0/16:0)', 'Ganglioside_GT2_(d18:0/14:0)', 'Ganglioside_GT2_(d18:0/12:0)', 'Ganglioside_GT1c_(d18:0/26:0)', 'Ganglioside_GT1c_(d18:0/25:0)', 'Ganglioside_GT1c_(d18:0/24:0)', 'Ganglioside_GT1c_(d18:0/23:0)', 'Ganglioside_GT1c_(d18:0/22:0)', 'Ganglioside_GT1c_(d18:0/20:0)', 'Ganglioside_GT1c_(d18:0/18:0)', 'Ganglioside_GT1c_(d18:0/16:0)', 'Ganglioside_GT1c_(d18:0/14:0)', 'Ganglioside_GT1c_(d18:0/12:0)', 'Ganglioside_GT1b_(d18:0/26:0)', 'Ganglioside_GT1b_(d18:0/25:0)', 'Ganglioside_GT1b_(d18:0/24:0)', 'Ganglioside_GT1b_(d18:0/23:0)', 'Ganglioside_GT1b_(d18:0/22:0)', 'Ganglioside_GT1b_(d18:0/20:0)', 'Ganglioside_GT1b_(d18:0/18:0)', 'Ganglioside_GT1b_(d18:0/16:0)', 'Ganglioside_GT1b_(d18:0/14:0)', 'Ganglioside_GT1b_(d18:0/12:0)', 'Ganglioside_GQ1c_(d18:0/26:0)', 'Ganglioside_GQ1c_(d18:0/25:0)', 'Ganglioside_GQ1c_(d18:0/24:0)', 'Ganglioside_GQ1c_(d18:0/23:0)', 'Ganglioside_GQ1c_(d18:0/22:0)', 'Ganglioside_GQ1c_(d18:0/20:0)', 'Ganglioside_GQ1c_(d18:0/18:0)', 'Ganglioside_GQ1c_(d18:0/16:0)', 'Ganglioside_GQ1c_(d18:0/14:0)', 'Ganglioside_GQ1c_(d18:0/12:0)', 'Ganglioside_GM3_(d18:0/26:0)', 'Ganglioside_GM3_(d18:0/25:0)', 'Ganglioside_GM3_(d18:0/24:0)', 'Ganglioside_GM3_(d18:0/23:0)', 'Ganglioside_GM3_(d18:0/22:0)', 'Ganglioside_GM3_(d18:0/20:0)', 'Ganglioside_GM3_(d18:0/18:0)', 'Ganglioside_GM3_(d18:0/16:0)', 'Ganglioside_GM3_(d18:0/14:0)', 'Ganglioside_GM3_(d18:0/12:0)', 'Ganglioside_GM2_(d18:0/26:0)', 'Ganglioside_GM2_(d18:0/25:0)', 'Ganglioside_GM2_(d18:0/23:0)', 'Ganglioside_GM2_(d18:0/22:0)', 'Ganglioside_GM2_(d18:0/20:0)', 'Ganglioside_GM2_(d18:0/18:0)', 'Ganglioside_GM2_(d18:0/16:0)', 'Ganglioside_GM2_(d18:0/14:0)', 'Ganglioside_GM2_(d18:0/12:0)', 'Ganglioside_GM1_(d18:0/26:0)', 'Ganglioside_GM1_(d18:0/25:0)', 'Ganglioside_GM1_(d18:0/24:0)', 'Ganglioside_GM1_(d18:0/23:0)', 'Ganglioside_GM1_(d18:0/22:0)', 'Ganglioside_GM1_(d18:0/20:0)', 'Ganglioside_GM1_(d18:0/18:0)', 'Ganglioside_GM1_(d18:0/16:0)', 'Ganglioside_GM1_(d18:0/14:0)', 'Ganglioside_GM1_(d18:0/12:0)', 'Ganglioside_GD3_(d18:0/26:0)', 'Ganglioside_GD3_(d18:0/25:0)', 'Ganglioside_GD3_(d18:0/24:0)', 'Ganglioside_GD3_(d18:0/23:0)', 'Ganglioside_GD3_(d18:0/22:0)', 'Ganglioside_GD3_(d18:0/20:0)', 'Ganglioside_GD3_(d18:0/18:0)', 'Ganglioside_GD3_(d18:0/16:0)', 'Ganglioside_GD3_(d18:0/14:0)', 'Ganglioside_GD3_(d18:0/12:0)', 'Ganglioside_GD2_(d18:0/26:0)', 'Ganglioside_GD2_(d18:0/25:0)', 'Ganglioside_GD2_(d18:0/24:0)', 'Ganglioside_GD2_(d18:0/23:0)', 'Ganglioside_GD2_(d18:0/22:0)', 'Ganglioside_GD2_(d18:0/20:0)', 'Ganglioside_GD2_(d18:0/18:0)', 'Ganglioside_GD2_(d18:0/16:0)', 'Ganglioside_GD2_(d18:0/14:0)', 'Ganglioside_GD2_(d18:0/12:0)', 'Ganglioside_GD1b_(d18:0/26:0)', 'Ganglioside_GD1b_(d18:0/25:0)', 'Ganglioside_GD1b_(d18:0/24:0)', 'Ganglioside_GD1b_(d18:0/23:0)', 'Ganglioside_GD1b_(d18:0/22:0)', 'Ganglioside_GD1b_(d18:0/20:0)', 'Ganglioside_GD1b_(d18:0/18:0)', 'Ganglioside_GD1b_(d18:0/16:0)', 'Ganglioside_GD1b_(d18:0/14:0)', 'Ganglioside_GD1b_(d18:0/12:0)', 'Ganglioside_GD1a_(d18:0/26:0)', 'Ganglioside_GD1a_(d18:0/25:0)', 'Ganglioside_GD1a_(d18:0/24:0)', 'Ganglioside_GD1a_(d18:0/23:0)', 'Ganglioside_GD1a_(d18:0/22:0)', 'Ganglioside_GD1a_(d18:0/20:0)', 'Ganglioside_GD1a_(d18:0/18:0)', 'Ganglioside_GD1a_(d18:0/16:0)', 'Ganglioside_GD1a_(d18:0/14:0)', 'Ganglioside_GD1a_(d18:0/12:0)']
TARGETS1=['Hyaluronic_acid', "Hyaluronan"]
TARGETS2=['Ganglioside_GT3_(d18:0/26:0)', 'Ganglioside_GT3_(d18:0/25:0)', 'Ganglioside_GT3_(d18:0/24:0)', 'Ganglioside_GT3_(d18:0/23:0)', 'Ganglioside_GT3_(d18:0/22:0)', 'Ganglioside_GT3_(d18:0/20:0)', 'Ganglioside_GT3_(d18:0/18:0)', 'Ganglioside_GT3_(d18:0/16:0)', 'Ganglioside_GT3_(d18:0/14:0)', 'Ganglioside_GT3_(d18:0/12:0)', 'Ganglioside_GT2_(d18:0/26:0)', 'Ganglioside_GT2_(d18:0/25:0)', 'Ganglioside_GT2_(d18:0/24:0)', 'Ganglioside_GT2_(d18:0/23:0)', 'Ganglioside_GT2_(d18:0/22:0)', 'Ganglioside_GT2_(d18:0/20:0)', 'Ganglioside_GT2_(d18:0/18:0)', 'Ganglioside_GT2_(d18:0/16:0)', 'Ganglioside_GT2_(d18:0/14:0)', 'Ganglioside_GT2_(d18:0/12:0)', 'Ganglioside_GT1c_(d18:0/26:0)', 'Ganglioside_GT1c_(d18:0/25:0)', 'Ganglioside_GT1c_(d18:0/24:0)', 'Ganglioside_GT1c_(d18:0/23:0)', 'Ganglioside_GT1c_(d18:0/22:0)', 'Ganglioside_GT1c_(d18:0/20:0)', 'Ganglioside_GT1c_(d18:0/18:0)', 'Ganglioside_GT1c_(d18:0/16:0)', 'Ganglioside_GT1c_(d18:0/14:0)', 'Ganglioside_GT1c_(d18:0/12:0)', 'Ganglioside_GT1b_(d18:0/26:0)', 'Ganglioside_GT1b_(d18:0/25:0)', 'Ganglioside_GT1b_(d18:0/24:0)', 'Ganglioside_GT1b_(d18:0/23:0)', 'Ganglioside_GT1b_(d18:0/22:0)', 'Ganglioside_GT1b_(d18:0/20:0)', 'Ganglioside_GT1b_(d18:0/18:0)', 'Ganglioside_GT1b_(d18:0/16:0)', 'Ganglioside_GT1b_(d18:0/14:0)', 'Ganglioside_GT1b_(d18:0/12:0)', 'Ganglioside_GQ1c_(d18:0/26:0)', 'Ganglioside_GQ1c_(d18:0/25:0)', 'Ganglioside_GQ1c_(d18:0/24:0)', 'Ganglioside_GQ1c_(d18:0/23:0)', 'Ganglioside_GQ1c_(d18:0/22:0)', 'Ganglioside_GQ1c_(d18:0/20:0)', 'Ganglioside_GQ1c_(d18:0/18:0)', 'Ganglioside_GQ1c_(d18:0/16:0)', 'Ganglioside_GQ1c_(d18:0/14:0)', 'Ganglioside_GQ1c_(d18:0/12:0)', 'Ganglioside_GM3_(d18:0/26:0)', 'Ganglioside_GM3_(d18:0/25:0)', 'Ganglioside_GM3_(d18:0/24:0)', 'Ganglioside_GM3_(d18:0/23:0)', 'Ganglioside_GM3_(d18:0/22:0)', 'Ganglioside_GM3_(d18:0/20:0)', 'Ganglioside_GM3_(d18:0/18:0)', 'Ganglioside_GM3_(d18:0/16:0)', 'Ganglioside_GM3_(d18:0/14:0)', 'Ganglioside_GM3_(d18:0/12:0)', 'Ganglioside_GM2_(d18:0/26:0)', 'Ganglioside_GM2_(d18:0/25:0)', 'Ganglioside_GM2_(d18:0/23:0)', 'Ganglioside_GM2_(d18:0/22:0)', 'Ganglioside_GM2_(d18:0/20:0)', 'Ganglioside_GM2_(d18:0/18:0)', 'Ganglioside_GM2_(d18:0/16:0)', 'Ganglioside_GM2_(d18:0/14:0)', 'Ganglioside_GM2_(d18:0/12:0)', 'Ganglioside_GM1_(d18:0/26:0)', 'Ganglioside_GM1_(d18:0/25:0)', 'Ganglioside_GM1_(d18:0/24:0)', 'Ganglioside_GM1_(d18:0/23:0)', 'Ganglioside_GM1_(d18:0/22:0)', 'Ganglioside_GM1_(d18:0/20:0)', 'Ganglioside_GM1_(d18:0/18:0)', 'Ganglioside_GM1_(d18:0/16:0)', 'Ganglioside_GM1_(d18:0/14:0)', 'Ganglioside_GM1_(d18:0/12:0)', 'Ganglioside_GD3_(d18:0/26:0)', 'Ganglioside_GD3_(d18:0/25:0)', 'Ganglioside_GD3_(d18:0/24:0)', 'Ganglioside_GD3_(d18:0/23:0)', 'Ganglioside_GD3_(d18:0/22:0)', 'Ganglioside_GD3_(d18:0/20:0)', 'Ganglioside_GD3_(d18:0/18:0)', 'Ganglioside_GD3_(d18:0/16:0)', 'Ganglioside_GD3_(d18:0/14:0)', 'Ganglioside_GD3_(d18:0/12:0)', 'Ganglioside_GD2_(d18:0/26:0)', 'Ganglioside_GD2_(d18:0/25:0)', 'Ganglioside_GD2_(d18:0/24:0)', 'Ganglioside_GD2_(d18:0/23:0)', 'Ganglioside_GD2_(d18:0/22:0)', 'Ganglioside_GD2_(d18:0/20:0)', 'Ganglioside_GD2_(d18:0/18:0)', 'Ganglioside_GD2_(d18:0/16:0)', 'Ganglioside_GD2_(d18:0/14:0)', 'Ganglioside_GD2_(d18:0/12:0)', 'Ganglioside_GD1b_(d18:0/26:0)', 'Ganglioside_GD1b_(d18:0/25:0)', 'Ganglioside_GD1b_(d18:0/24:0)', 'Ganglioside_GD1b_(d18:0/23:0)', 'Ganglioside_GD1b_(d18:0/22:0)', 'Ganglioside_GD1b_(d18:0/20:0)', 'Ganglioside_GD1b_(d18:0/18:0)', 'Ganglioside_GD1b_(d18:0/16:0)', 'Ganglioside_GD1b_(d18:0/14:0)', 'Ganglioside_GD1b_(d18:0/12:0)', 'Ganglioside_GD1a_(d18:0/26:0)', 'Ganglioside_GD1a_(d18:0/25:0)', 'Ganglioside_GD1a_(d18:0/24:0)', 'Ganglioside_GD1a_(d18:0/23:0)', 'Ganglioside_GD1a_(d18:0/22:0)', 'Ganglioside_GD1a_(d18:0/20:0)', 'Ganglioside_GD1a_(d18:0/18:0)', 'Ganglioside_GD1a_(d18:0/16:0)', 'Ganglioside_GD1a_(d18:0/14:0)', 'Ganglioside_GD1a_(d18:0/12:0)']

Hyaluronan=set(TARGETS) #Node to look at
print Hyaluronan

PROTEINS=set()
for target in TARGETS:
    Hyaluronan.update(METABO_NT.neighbors(target))
    PROTEINS.update(METABO_NT.neighbors(target))
print Hyaluronan
print PROTEINS

Hyaluronan_network=METABO_NT.subgraph(Hyaluronan)

#Draw subgraph
#Draw metabolites first
plt.figure(figsize=(25,12))
pos=NX.spring_layout(Hyaluronan_network)
NX.draw_networkx_nodes(Hyaluronan_network, pos,nodelist=TARGETS1, node_color="b", node_size=200)
NX.draw_networkx_nodes(Hyaluronan_network, pos,nodelist=TARGETS2, node_color="g", node_size=200)

#Then draw proteins
NX.draw_networkx_nodes(Hyaluronan_network, pos,nodelist=PROTEINS, node_color="r", node_size=100)

#Then draw edges
NX.draw_networkx_edges(Hyaluronan_network, pos, width=0.1, with_labels=False)

#Then point out desired lables
labels={}
labels['Hyaluronic_acid']='Hyaluronic_acid'
labels["Hyaluronan"]="Hyaluronan"
NX.draw_networkx_labels(Hyaluronan_network, pos, labels, font_size=8)

plt.show()